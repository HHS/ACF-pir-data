name: Update Documentation
run-name: ${{ github.actor }} has made or updated a pull request; updating documentation.
on: pull_request

jobs:
  update-documentation:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pages: write
      id-token: write
    steps:
      - name: Check out repository code
        id: checkout
        uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955
      - name: Update documentation
        id: update
        run: bash code/create_sphinx_docs.sh
      - name: Commit and push documentation
        id: push
        run: |
          git config user.email "${{ github.actor_id }}+${{ github.actor }}@users.noreply.github.com"
          git config user.name "${{ github.actor }}"
          git add .
          git commit -m "Update documentation"
          git push
        continue-on-error: true
      - name: Setup Github pages
        id: setup
        uses: actions/configure-pages@983d7736d9b0ae728b81ab479565c72886d7745b
      - name: Upload artifact
        id: upload
        uses: actions/upload-pages-artifact@0252fc4ba7626f0298f0cf00902a25c6afc77fa8
        with:
          path: "documentation/build/html"
      - name: Deploy to GitHub pages
        id: deployment
        uses: actions/deploy-pages@d6db90164ac5ed86f2b6aed7e0febac5b3c0c03e